{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Total Arrivals in Australia from Jan-2015 to Aug-2025",
  "description": "Bar chart of visitor numbers (Total only) from Jan-2015 to Aug-2025.",
  "width": 700,
  "height": 400,
  "data": { "url": "data/citizenship_arrival.csv" },
  "transform": [
    { "filter": "datum.Country == 'Total'" },
    { "calculate": "timeParse(datum.Month, '%b-%Y')", "as": "Date" },
    {
      "filter": "datum.Date >= datetime(2015, 0, 1) && datum.Date <= datetime(2025, 7, 31)"
    },
    { "calculate": "toDate('2020-03-01')", "as": "AnnoDate" } 
  ],
  "layer": [
    {
      "mark": "bar",
      "encoding": {
        "x": {
          "field": "Date",
          "type": "temporal",
          "title": "Date",
          "axis": {
            "format": "%b %Y",
            "labelAngle": -45,
            "tickCount": {"interval": "month", "step": 1},
            "labelOverlap": true
          }
        },
        "y": {"field": "Value", "type": "quantitative", "title": "Visitors"},
        "tooltip": [
          {"field": "Month", "type": "nominal"},
          {"field": "Value", "type": "quantitative", "format": ","}
        ]
      }
    },
    {
      "mark": { "type": "rule", "color": "red", "size": 2 },
      "encoding": {
        "x": { "field": "AnnoDate", "type": "temporal" }
      }
    },
    {
      "mark": {
        "type": "text",
        "color": "red",
        "fontSize": 12,
        "fontWeight": "bold",
        "dx": 6,
        "dy": -8
      },
      "encoding": {
        "x": { "field": "AnnoDate", "type": "temporal" },
        "y": { "aggregate": "max", "field": "Value" },
        "text": { "value": "COVID restrictions started (Mar 2020)" }
      }
    }
  ],
  "config": {
    "view": {"stroke": "transparent"},
    "axis": {"labelFontSize": 12, "titleFontSize": 13}
  }
}
